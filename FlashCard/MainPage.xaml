<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Shell.NavBarIsVisible="False"
             x:Class="FlashCard.MainPage">

    <!--Background Image-->
    <Grid>
        <Image Source="pokemonbg.jpg"
               Aspect="AspectFill"
               Opacity="0.7" />

        <!--Main Content-->
        <ScrollView>
            <VerticalStackLayout Padding="20" Spacing="20">

                <!--Progress Bar Section-->
                <Border BackgroundColor="White"
                        Padding="15"
                        StrokeThickness="3"
                        Stroke="#FFCB05">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="15" />
                    </Border.StrokeShape>

                    <VerticalStackLayout Spacing="8">
                        <Label x:Name="progressLabel"
                               Text="0/10 Pokémon Revealed"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="#333333"
                               HorizontalTextAlignment="Center" />

                        <ProgressBar x:Name="progressBar"
                                     Progress="0"
                                     ProgressColor="#FFCB05"
                                     HeightRequest="12" />
                    </VerticalStackLayout>
                </Border>

                <!--CarouselView-->
                <Border StrokeThickness="0"
                        Padding="5"
                        BackgroundColor="Transparent">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="20" />
                    </Border.StrokeShape>

                    <CarouselView x:Name="NumberCarousel"
                                  HeightRequest="450"
                                  IndicatorView="indicator"
                                  PositionChanged="OnCarouselPositionChanged"
                                  HorizontalOptions="Fill">
                        <CarouselView.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="15,10"
                                        Padding="0"
                                        HeightRequest="430"
                                        HorizontalOptions="Center"
                                        VerticalOptions="Center"
                                        BackgroundColor="White"
                                        StrokeThickness="6">
                                    <Border.Stroke>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Color="#FFCB05" Offset="0.0" />
                                            <GradientStop Color="#3B4CCA" Offset="0.5" />
                                            <GradientStop Color="#CC0000" Offset="1.0" />
                                        </LinearGradientBrush>
                                    </Border.Stroke>
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="25" />
                                    </Border.StrokeShape>

                                    <Grid RowDefinitions="Auto,*,Auto" Padding="20">
                                        <!--Card Header-->
                                        <Border Grid.Row="0"
                                                BackgroundColor="#CC0000"
                                                Padding="15,10"
                                                Margin="0,0,0,15"
                                                StrokeThickness="3"
                                                HorizontalOptions="Center"
                                                VerticalOptions="Center"
                                                Stroke="Gold">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="12" />
                                            </Border.StrokeShape>
                                            <Label Text="WHO'S THAT POKÉMON?"
                                                   FontSize="20"
                                                   FontAttributes="Bold"
                                                   TextColor="White"
                                                   HorizontalTextAlignment="Center"
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center" />

                                        </Border>

                                        <!--Pokemon Image-->
                                        <Border Grid.Row="1"
                                                BackgroundColor="#F0F0F0"
                                                Padding="20"
                                                StrokeThickness="3"
                                                Stroke="#FFCB05">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="15" />
                                            </Border.StrokeShape>
                                            <Image x:Name="pokemonImg"
                                                   Source="{Binding Value.ImageFile}"
                                                   WidthRequest="200" 
                                                   HeightRequest="200"
                                                   Aspect="AspectFit"
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center">
                                                <Image.Shadow>
                                                    <Shadow Brush="Gray"
                                                            Offset="0,6"
                                                            Radius="5"
                                                            Opacity="0.5" />
                                                </Image.Shadow>
                                            </Image>
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CarouselView.ItemTemplate>
                    </CarouselView>
                </Border>

                <!--Page Indicator-->
                <IndicatorView x:Name="indicator"
                               IndicatorColor="#E0E0E0"
                               SelectedIndicatorColor="#CC0000"
                               IndicatorSize="12"
                               HorizontalOptions="Center"
                               Margin="0,-10,0,0" />

                <!--Feedback Banner (Hidden by default)-->
                <Border x:Name="feedbackBorder"
                        IsVisible="False"
                        Padding="15"
                        StrokeThickness="0"
                        BackgroundColor="#4CAF50">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12" />
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black"
                                Offset="0,4"
                                Radius="8"
                                Opacity="0.3" />
                    </Border.Shadow>

                    <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                        <Label x:Name="feedbackMessage"
                               Text="Correct!"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="White"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </Border>

                <!--Answer Input Section-->
                <Border BackgroundColor="White"
                        Padding="15"
                        StrokeThickness="3"
                        Stroke="#3B4CCA">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="15" />
                    </Border.StrokeShape>

                    <VerticalStackLayout Spacing="10">
                        <Entry x:Name="txtAnswer"
                               FontSize="20"
                               Placeholder="Enter Pokémon name..."
                               PlaceholderColor="#999999"
                               TextColor="#333333"
                               BackgroundColor="White"
                               HeightRequest="50" />

                        <Button Text="SUBMIT ANSWER"
                                Clicked="OnEnterClicked"
                                x:Name="btnSubmit"
                                FontSize="18"
                                FontAttributes="Bold"
                                TextColor="White"
                                BackgroundColor="#4CAF50"
                                BorderColor="Black"
                                BorderWidth="2"
                                CornerRadius="12"
                                HeightRequest="50"
                                Padding="20,10">
                        </Button>
                    </VerticalStackLayout>
                </Border>

                <!--Navigation Buttons-->
                <Grid ColumnDefinitions="*,*,*" 
                      ColumnSpacing="10"
                      Margin="0,5,0,5">

                    <Button Grid.Column="0"
                            Text="◀ PREV"
                            Clicked="OnPrevClicked"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="White"
                            BackgroundColor="#007BFF"
                            BorderColor="White"
                            BorderWidth="2"                            
                            CornerRadius="15"
                            HeightRequest="50">
                        <Button.Shadow>
                            <Shadow Brush="Black"
                                    Offset="0,3"
                                    Radius="5"
                                    Opacity="0.3" />
                        </Button.Shadow>
                    </Button>

                    <Button Grid.Column="1"
                            Text="SHUFFLE"
                            Clicked="OnShuffleClicked"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="White"
                            BackgroundColor="#FFD500"
                            BorderColor="White"
                            BorderWidth="2"
                            CornerRadius="15"
                            HeightRequest="50">
                        <Button.Shadow>
                            <Shadow Brush="Black"
                                    Offset="0,3"
                                    Radius="5"
                                    Opacity="0.3" />
                        </Button.Shadow>
                    </Button>

                    <Button Grid.Column="2"
                            Text="NEXT ▶"
                            Clicked="OnNextClicked"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="White"
                            BackgroundColor="#28A745"
                            BorderColor="White"
                            BorderWidth="2"
                            CornerRadius="15"
                            HeightRequest="50">
                        <Button.Shadow>
                            <Shadow Brush="Black"
                                    Offset="0,3"
                                    Radius="5"
                                    Opacity="0.3" />
                        </Button.Shadow>
                    </Button>
                </Grid>
                <Button Text="RESET"
                        Clicked="OnResetClicked"
                        FontSize="16"
                        FontAttributes="Bold"
                        TextColor="White"
                        BackgroundColor="#D32F2F"
                        BorderColor="White" 
                        BorderWidth="2"
                        CornerRadius="15"
                        HeightRequest="50">
                    <Button.Shadow>
                        <Shadow Brush="Black"
                                Offset="0,3"
                                Radius="5"
                                Opacity="0.3" />
                    </Button.Shadow>
                </Button>
            </VerticalStackLayout>
        </ScrollView>

        <!--Completion Celebration Overlay-->
        <Grid x:Name="completionOverlay"
              IsVisible="False"
              BackgroundColor="#80000000">

            <Border x:Name="completionContent"
                    BackgroundColor="White"
                    Padding="30"
                    StrokeThickness="6"
                    HorizontalOptions="Center"
                    VerticalOptions="Center"
                    WidthRequest="350"
                    MaximumHeightRequest="400">
                <Border.Stroke>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#FFCB05" Offset="0.0" />
                        <GradientStop Color="#CC0000" Offset="1.0" />
                    </LinearGradientBrush>
                </Border.Stroke>
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="25" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Offset="0,10"
                            Radius="20"
                            Opacity="0.5" />
                </Border.Shadow>

                <VerticalStackLayout Spacing="20">

                    <Label Text="CONGRATULATIONS!"
                           FontSize="26"
                           FontAttributes="Bold"
                           TextColor="#CC0000"
                           HorizontalTextAlignment="Center" />

                    <Label Text="You've revealed all Pokémon!"
                           FontSize="18"
                           TextColor="#333333"
                           HorizontalTextAlignment="Center"
                           Margin="0,0,0,10" />

                    <BoxView HeightRequest="2"
                             BackgroundColor="#E0E0E0"
                             Margin="0,5" />

                    <Button Text="PLAY AGAIN"
                            Clicked="OnResetAfterCompletionClicked"
                            FontSize="18"
                            FontAttributes="Bold"
                            TextColor="White"
                            BackgroundColor="#4CAF50"
                            BorderColor="#2E7D32"
                            BorderWidth="2"
                            CornerRadius="12"
                            HeightRequest="50" />

                    <Button Text="CONTINUE EXPLORING"
                            Clicked="OnContinueClicked"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="#007BFF"
                            BackgroundColor="Transparent"
                            BorderColor="#007BFF"
                            BorderWidth="2"
                            CornerRadius="12"
                            HeightRequest="50" />
                </VerticalStackLayout>
            </Border>
        </Grid>

        <!--Reset Confirmation Overlay-->
        <Grid x:Name="resetOverlay"
              IsVisible="False"
              BackgroundColor="#80000000">

            <Border x:Name="resetContent"
                    BackgroundColor="White"
                    Padding="30"
                    StrokeThickness="4"
                    Stroke="#D32F2F"
                    HorizontalOptions="Center"
                    VerticalOptions="Center"
                    WidthRequest="320"
                    MaximumHeightRequest="350">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="20" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="Black"
                            Offset="0,8"
                            Radius="15"
                            Opacity="0.4" />
                </Border.Shadow>

                <VerticalStackLayout Spacing="20">
                    <Label Text="Reset Progress?"
                           FontSize="22"
                           FontAttributes="Bold"
                           TextColor="#333333"
                           HorizontalTextAlignment="Center" />

                    <Label Text="This will hide all revealed Pokémon and restart your progress."
                           FontSize="15"
                           TextColor="#666666"
                           HorizontalTextAlignment="Center"
                           Margin="0,0,0,10" />

                    <BoxView HeightRequest="2"
                             BackgroundColor="#E0E0E0"
                             Margin="0,5" />

                    <Button Text="YES, RESET"
                            Clicked="OnConfirmResetClicked"
                            FontSize="18"
                            FontAttributes="Bold"
                            TextColor="White"
                            BackgroundColor="#D32F2F"
                            BorderColor="#B71C1C"
                            BorderWidth="2"
                            CornerRadius="12"
                            HeightRequest="50" />

                    <Button Text="CANCEL"
                            Clicked="OnCancelResetClicked"
                            FontSize="16"
                            FontAttributes="Bold"
                            TextColor="#666666"
                            BackgroundColor="Transparent"
                            BorderColor="#CCCCCC"
                            BorderWidth="2"
                            CornerRadius="12"
                            HeightRequest="50" />
                </VerticalStackLayout>
            </Border>
        </Grid>
    </Grid>

</ContentPage>
